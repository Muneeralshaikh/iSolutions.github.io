<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js" type="text/javascript"></script>
  </head>
  <body>
      <h3>Call AirTime API</h3>
      <p id='showMsg'></p>
   
    <script type="text/javascript">
        document.getElementById('showMsg').innerHTML = 'Checking...';
        let fetchURL = "https://api.qa.umbai.africa/airtime/quote?productName=zimbabweairtime&amount=123.45&receiverNumber=26371000111";
        let options = {
          "async": true,
          "crossDomain": true,
          "mode" : "no-cors",
          "method" : "GET",
          "Access-Control-Allow-Origin" : "*",
          "headers" : {
            "Authorization" : "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImUwMWJkMzNhMjM0ZDZlZTM0YTFlN2Q2Mjk2NWQwODliIiwidHlwIjoiSldUIn0.eyJuYmYiOjE2ODA4NzI0ODksImV4cCI6MTY4MDg3NjA4OSwiaXNzIjoiaHR0cHM6Ly9pZGVudGl0eS5xYS51bWJhaS5hZnJpY2EiLCJhdWQiOlsiaHR0cHM6Ly9pZGVudGl0eS5xYS51bWJhaS5hZnJpY2EvcmVzb3VyY2VzIiwiYXBpMSIsImUiXSwiY2xpZW50X2lkIjoiY2hfOTc3ZTMzOGMtZGY5YS00MzBiLTk3OTMtYjcyNjUwMGViYzg0IiwiY2xpZW50X1ZlbmRvciI6Ijk3N2UzMzhjLWRmOWEtNDMwYi05NzkzLWI3MjY1MDBlYmM4NCIsImNsaWVudF9WZW5kb3JOYW1lIjoiQ2hlbmdldGFEaWFzcG9yYSIsInNjb3BlIjpbImFwaTEiLCJlIl19.ekK1vywczs32xiwB4JFWOE3TY_vO28EDRU_lSeZrNDiOr9kTTzmrYKmghKBvhbIUItABT4C68cvOjDkigjqUvIlmIlcpIv2aS1jDj2Ce6h6HRogqPGrDwDT4x_3QRzHRNXGr3cYatvvXdttwbh0LGgCgcjifPavcnpfmN2VVoXYJFE2eWan8yjYD8dXaDqG5jM-o8kcn37lfSGHclu1gArj2r6fYPsT6uvt2osaangehko-BffMS47TkTntcX5C37oV4KzTv5qQgLMfuEIdCYRTKbEzPax3siPEx1K96_QaWyPU-_BtGkudqama8SiKXCrqPNz4hzprvXj8tCxv3KA",
            "Content-Type" : "application/json",
            "cache-control": "no-cache"
          }
        };
        async function fetchAirtime() {
          try{
            const res = await fetch(fetchURL, options)
            const quote = await res.text();
            console.log(quote);
            return quote;
          }catch(err){
              console.error(err); 
          }
        }

        // fetchAirtime().then(quote => {
        //   quote; // fetched quote
        // });

   fetch("https://api.qa.umbai.africa/airtime/quote?productName=zimbabweairtime&amount=123.45&receiverNumber=26371000111", options);
 

        // ThunkableWebviewerExtension.receiveMessage(function(message) {
        //     const bs64Obj = JSON.parse(message);
        //     const aTag = document.getElementById("dlFile"); //Create <a>
        //     aTag.download = bs64Obj[0]; //File name Here
        //     aTag.href = bs64Obj[1]; //Image Base64 Goes here
        //     aTag.innerHTML = bs64Obj[0];
        //     // aTag.click(); //Downloaded file
        //     document.getElementById('showMsg').innerHTML = 'Download ' + bs64Obj[0];
            // ThunkableWebviewerExtension.postMessage('Done');
        // });
    </script>
</body>
</html>